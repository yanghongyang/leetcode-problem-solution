<!--
 * @Description:
 * @Author: Hongyang_Yang
 * @Date: 2020-09-11 10:53:29
 * @LastEditors: Hongyang_Yang
 * @LastEditTime: 2020-09-11 11:45:02
-->

# 恨铁不成钢的前言（为什么当初没有好好学习！）

本篇的初衷是记录常见的位运算技巧。但由于某些因缘，~~就是连续两天因为位运算符的优先级问题，累计 debug 时长达 40 分钟以上气得我牙痒痒~~，决定在介绍常见的位运算用法前，从最基础的知识开始讲起。

留作复习用。

# 运算符优先级

## 缘起

见 [Leetcode 397.整数替换](https://leetcode-cn.com/problems/integer-replacement/) 。

这题讲道理，是不难的。那么是什么让我 debug 了长达 20 分钟呢？~~缘分！一定是缘分！（已疯）~~

在判断的时候我写了一小段这样的代码：

```cpp
if (n & 1 == 0)
    n >>= 1; //如果是偶数的话直接除以2就行啦
```

如果看到这里读者你觉得没有什么问题，那可能以后相同的坑你可能也要傻乎乎地跳进去啦~

事实上这么写忽视了运算符的优先级问题，导致运行时出现 **TLE** 。

没错我就是这么哼哧哼哧改了半天......~~太沙雕了。想抽自己。~~

正确的写法应该是这样滴：

```cpp
if ((n & 1) == 0)
    n >>= 1; //如果是偶数的话直接除以2就行啦
```

嗯就是加了对括号......

这涉及到位运算符的优先级问题！

## 运算符优先级！（划重点！建议全文背诵！）

**声明** 以下内容摘自 [位运算优先级](https://blog.csdn.net/yiqzq/article/details/81144342)

| 优先级 | 运算符       | 描述                    |
| ------ | ------------ | ----------------------- |
| 1      | 括号         | ()、[]                  |
| 2      | 正负号       | +、-                    |
| 3      | 自增自减、非 | ++、--、!               |
| 4      | 乘除、取余   | \*、/、%                |
| 5      | 加减         | +、-                    |
| 6      | 移位运算     | <<、>>、>>>             |
| 7      | 大小关系     | >、>=、<、<=            |
| 8      | 相等关系     | ==、!=                  |
| 9      | 按位与       | &                       |
| 10     | 按位异或     | ^                       |
| 11     | 按位或       | \|                      |
| 12     | 逻辑与       | &&                      |
| 13     | 逻辑或       | \|\|                    |
| 14     | 条件运算     | ?:                      |
| 15     | 赋值运算     | =、+=、-=、\*=、/=、%=  |
| 16     | 位赋值运算   | &=、\|=、<<=、>>=、>>>= |

从表中可以看出，`==` 的优先级是高于 `&` 的。所以在计算的时候先计算了 `1==0` ，接着再拿 `n` 和一个不知道值是多少的数（反正不是 0）按位与了。因为每一次计算的时候 `1==0` 都不知道是多少，所以 **缘起** 中的程序会 `TLE` 。

## 一句话总结

写程序，尤其是要用到 **按位运算/逻辑运算** 的时候，保险起见一定要加括号啊！程序丑一点没关系，但是一定要保证正确呀。
